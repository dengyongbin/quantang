// JavaScript Document
//<script type="text/javascript" charset="utf-8">
	var chartData = [];
	var t;
	$(document).ready(function() {
		$("#article1").mouseover(function() {
			$("#info1").show();
		});
		$("#article2").mouseover(function() {
			$("#info2").show();
		});
		$("#article3").mouseover(function() {
			$("#info3").show();
		});
		$("#article1").mouseout(function() {
			$("#info1").hide();
		});
		$("#article2").mouseout(function() {
			$("#info2").hide();
		});
		$("#article3").mouseout(function() {
			$("#info3").hide();
		});
		$("#editerform").submit(function() {
			var options = {
				dataType : 'json',
				resetForm : false,
				success : showSuccess,
				error : showError,
				timeout : 10000
			}
			$(this).ajaxSubmit(options);
			return false;
		});
		document.getElementById('tb1').click();
	});
	
	function dataSet(obj) {
		dailyLine(obj);
		$.ajax({
			url : "currentdata.htm?cclass=" + obj,
			type : "post",
			dataType : "json",
			success : function(data) {
				currentSet(data);
			}
		});
		$("#nowclass").val(obj);
	}
	
	function submit() {
		var name = $("#name").val();
		var sex = $("#sex").val();
		var age = $("#age").val();
		var phone = $("#phone").val();
		var email = $("#email").val();
		if (name.length == 0 || name.length > 50) {
			$("#name").focus();
			return;
		}
		if (phone.length == 0 || email.length > 50) {
			$("#email").focus();
			return;
		}
		if (phone.length == 0 || phone.length > 30) {
			$("#phone").focus();
			return;
		}
	    
		$.ajax({
			url : "rightSubmit.htm",
			type : "post",
			data : {
				"name" : name,
				"phone" : phone,
				"email" : email,
				"sex" : sex,
				"age" : age
			},
			dataType : "text",
			success : function(data) {
				$("#name").val("");
				$("#email").val("");
				$("#phone").val("");
				$("#age").attr("value", "1");
				$("#sex").attr("value", "1");
				alert('您好,我们已收到您的预约申请,请等候工作人员与您联系!');
			}
		});
	}
	
	//6.23 行情走势  自动获取时间 
	$(function(){
			var oEm = document.getElementsByTagName('em');
			//var oEm = $("em");
			//alert(oEm.length);
			
			var myTime = new Date();
			var iYear = myTime.getFullYear();
			var iMonth = myTime.getMonth()+1;
			var iDate = myTime.getDate();
			var str = iYear + '年' + toTwo(iMonth) + '月' + toTwo(iDate)+'日';
			
			for(var i=0; i<oEm.length; i++){
				oEm[i].innerHTML = str;
			}

			function toTwo(n){
				return n<10?'0'+n:''+n;
			}
	});
	function dailyLine(obj) {
		$.getJSON('dailydata.htm?cclass=' + obj, function(result) {
			var datas = [],i;
			for (i = 0; i < result.length; i++) {
				datas.push([parseInt(result[i].tradedate), parseFloat(result[i].price)]);
			}
			Highcharts.setOptions({
				global: {
					useUTC: false
				}
			});
			$('#chartdiv').highcharts({
				chart: {
					events: {
						load: function() {
							var series = this.series[0];
							setInterval(function() {
								$.ajax({
									url: "currentdata.htm?cclass=" + $("#nowclass").val(),
									type: "post",
									dataType: "json",
									success: function(data) {
										series.addPoint([parseInt(data[0].tradedate), parseFloat(data[0].price)], true, true);
										currentSet(data);
									}
								});
							}, 20000);
						}
					}
				},
				title: {
					text: false
				},
				exporting: {
					enabled: false
				},
				series: [{
					lineWidth: 1,
					marker: {
						enabled: false
					},
					states: {
						hover: {
							enabled: false
						}
					},
					data: datas
				}],
				xAxis: {
					type: 'datetime',
					dateTimeLabelFormats: {
						hour: '%H:%M',
					},

				},
				yAxis: {
					title: {
						text: false
					},
				},
				legend: {
					enabled: false
				},
				tooltip: {
					crosshairs: [{
						width: 1,
						color: 'red'
					}, {
						width: 1,
						color: 'red'
					}],
					formatter: function() {
						return '<b>日期：</b>' + Highcharts.dateFormat('%H:%M:%S', this.x) + '<br/>' + '<b>价位：</b>' + this.y;
					},
					borderColor: '#000000'
				},
				scrollbar: {
					enabled: false
				}
			});
		});
	}

	function currentSet(data) {
		if (data != '') {
			var objs = data;
			$(".tab-pane.active span[name='price']").html(
			objs[0].price);
			$(".tab-pane.active span[name='changerate']").html(
			objs[0].changerate);
			$(".tab-pane.active span[name='openprice']").html(
			objs[0].openprice);
			$(".tab-pane.active span[name='buy']").html(
			objs[0].buy);
			$(".tab-pane.active span[name='sell']").html(
			objs[0].sell);
			$(".tab-pane.active span[name='maxprice']").html(
			objs[0].maxprice);
			$(".tab-pane.active span[name='minprice']").html(
			objs[0].minprice);
			$(".tab-pane.active span[name='yestodayprice']").html(objs[0].yestodayprice);

			$(".tab-pane.active i[name='rate']").removeClass();
			$(".tab-pane.active span[name='price']").removeClass();
			$(".tab-pane.active i[name='rate']").parent().removeClass();
			$(".tab-pane.active i[name='count']").parent().removeClass();

			if (objs[0].changerate.split("%")[0] > 0) {
				$(".tab-pane.active span[name='price']").addClass(" rate-up");
				$(".tab-pane.active i[name='rate']").parent().addClass(" rate-up");
				/*$(".tab-pane.active i[name='rate']").addClass(
						"fa rate  fa-long-arrow-up");*/
				$(".tab-pane.active i[name='rate']").addClass("arrow-up");
				$(".tab-pane.active span[name='count']").addClass("count-up");
			} else {
				$(".tab-pane.active span[name='price']").addClass(" rate-down");
				$(".tab-pane.active i[name='rate']").parent().addClass("rate-down");
				/*$(".tab-pane.active i[name='rate']").addClass(
						"fa rate  fa-long-arrow-down");*/
				$(".tab-pane.active i[name='rate']").addClass("arrow-down");
				$(".tab-pane.active span[name='count']").addClass("count-down");
			}
		}
	}
//</script>